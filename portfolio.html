<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Kunshi | Illuminate your Brand</title>
    <link rel="icon" href="images/Other images/logo.png" type="image/png">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <link rel="stylesheet" href="style.css">
    <meta name="robots" content="noindex,nofollow">
    <meta http-equiv="Content-Security-Policy" content="img-src 'self'">
</head>
<body>
    <!-- Enhanced Preloader -->
    <div id="preloader">
        <div class="loader">
            <div class="loader-circle"></div>
            <div class="loader-circle"></div>
            <div class="loader-circle"></div>
            <img src="images/Other images/logo.png" alt="Logo" class="loader-logo">
            <div class="loader-text">LOADING...</div>
        </div>
        <div class="loader-brand">KUNSHI</div>
    </div>
    
    <!-- Header -->
    <header>
        <div class="container">
            <nav>
                <a href="/" class="logo">
                    <img src="images/Other images/logo.png" alt="Logo" class="logo-img">
                    <span class="logo-text">Kunshi</span>
                </a>
                <div class="nav-links" id="navLinks">
                    <a href="/">Home</a>
                    <a href="/#about">About</a>
                    <a href="/#skills">Skills</a>
                    <a href="/#featured">Featured</a>
                    <a href="/portfolio" class="active">Portfolio</a>
                    <a href="/#contact">Contact</a>
                </div>
                <div class="menu-toggle" id="menuToggle">
                    <i class="fas fa-bars"></i>
                </div>
            </nav>
        </div>
    </header>

    <!-- Portfolio Filter Section -->
    <section class="portfolio-filter-section">
        <div class="container">
            <div class="section-header portfolio-header">
                <h2>Explore My Work</h2>
                <p class="section-subtitle">Filter by category to find specific projects</p>
            </div>
            
            <div class="filter-container">
                <div class="portfolio-filters">
                    <button class="filter-btn active" data-filter="all">All Projects</button>
                    <button class="filter-btn" data-filter="Car-Brand-Insta-Post">Car Brand</button>
                    <button class="filter-btn" data-filter="Print-Brand-Insta-Post">Print Brand</button>
                    <button class="filter-btn" data-filter="Camera-Brand-Insta-Post">Camera Brand</button>
                    <button class="filter-btn" data-filter="Facebook-Banners">Facebook Banners</button>
                    <button class="filter-btn" data-filter="Hotel-Menu">Hotel Menu</button>
                    <button class="filter-btn" data-filter="A4-size-Posters">A4 Posters</button>
                    <button class="filter-btn" data-filter="Restaurant-Insta-Post">Restaurant</button>
                </div>
            </div>
        </div>
    </section>

    <!-- Portfolio Grid -->
    <section class="portfolio-grid-section">
        <div class="container">
            <div class="portfolio-grid" id="portfolioGrid">
                <!-- Loading state -->
                <div class="portfolio-item" data-category="loading">
                    <div class="portfolio-image">
                        <div class="loading-container">
                            <div class="loading-spinner"></div>
                            <div class="loading-text">Loading amazing projects...</div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Empty state (will be shown/hidden via JS) -->
            <div class="empty-state" id="emptyState" style="display: none;">
                <div class="empty-icon">
                    <i class="fas fa-search"></i>
                </div>
                <h3>No projects found</h3>
                <p>No projects match your current filter. Try selecting a different category.</p>
                <button class="btn btn-primary reset-filter-btn">Show All Projects</button>
            </div>
        </div>
    </section>

    <!-- Project Modal -->
    <div class="project-modal" id="projectModal">
        <div class="modal-content">
            <span class="close-modal" title="Close Image">&times;</span>
            <div class="modal-body" id="modalBody">
                <!-- Content will be loaded dynamically -->
            </div>
            <div class="modal-navigation">
                <button class="nav-btn prev-btn" id="prevProject">
                    <i class="fas fa-chevron-left"></i>
                </button>
                <button class="nav-btn next-btn" id="nextProject">
                    <i class="fas fa-chevron-right"></i>
                </button>
            </div>
        </div>
    </div>

    <!-- Call to Action Section -->
    <section class="portfolio-cta">
        <div class="container">
            <div class="cta-content">
                <h2>Ready to Start Your Project?</h2>
                <p>Let's collaborate to bring your creative vision to life with stunning designs.</p>
                <a href="/#contact" class="btn">Get In Touch</a>
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer>
        <div class="container">
            <div class="footer-content">
                <div class="footer-logo">
                    <a href="/"><img src="images/Other images/logo.png" alt="Logo" class="footer-logo-img"></a>
                </div>
                <div class="footer-links">
                    <a href="/">Home</a>
                    <a href="/#about">About</a>
                    <a href="/#skills">Skills</a>
                    <a href="/portfolio">Portfolio</a>
                    <a href="/#contact">Contact</a>
                </div>
                <div class="footer-copyright">
                    <p>&copy; 2025 Kunshi. All rights reserved.</p>
                </div>
            </div>
        </div>
    </footer>

    <script>
        // Debug function to check image existence
        function checkImageExists(url, callback) {
            const img = new Image();
            img.onload = function() { callback(true); };
            img.onerror = function() { callback(false); };
            img.src = url;
        }
        
        // Portfolio items data structure
        const portfolioData = {
            'Car-Brand-Insta-Post': {
                folderName: 'Car Brand Insta Post',
                count: 21,
                title: 'Car Brand',
                description: 'Instagram post designs for automotive brands'
            },
            'Print-Brand-Insta-Post': {
                folderName: 'Print Brand Insta Post',
                count: 10,
                title: 'Print Brand',
                description: 'Instagram post designs for print services'
            },
            'Camera-Brand-Insta-Post': {
                folderName: 'Camera Brand Insta Post',
                count: 15,
                title: 'Camera Brand',
                description: 'Instagram post designs for photography equipment'
            },
            'Facebook-Banners': {
                folderName: 'Facebook Banners',
                count: 3,
                title: 'Facebook Banners',
                description: 'Custom designed social media banners'
            },
            'Hotel-Menu': {
                folderName: 'Hotel Menu',
                count: 2,
                title: 'Hotel Menu',
                description: 'Menu design for hospitality industry'
            },
            'A4-size-Posters': {
                folderName: 'A4 size Posters',
                count: 3,
                title: 'A4 Posters',
                description: 'Print-ready promotional poster designs'
            },
            'Restaurant-Insta-Post': {
                folderName: 'Restaurant Insta Post',
                count: 19,
                title: 'Restaurant',
                description: 'Instagram post designs for food services'
            }
        };

        // Configuration variables
        let baseImagePath = 'images/';
        let imageExtension = '.jpg'; // Use .jpg for portfolio images
        let currentCategory = 'all';
        let currentImageIndex = 0;
        let visibleItems = [];

        // Fisher-Yates shuffle algorithm
        function shuffleArray(array) {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]];
            }
            return array;
        }
        
        // Function to generate portfolio items
        function generatePortfolioItems() {
            const portfolioGrid = document.getElementById('portfolioGrid');
            portfolioGrid.innerHTML = ''; // Clear existing items
            
            console.log(`Generating portfolio with base path: ${baseImagePath} and extension: ${imageExtension}`);
            
            // Debug: Check if portfolioGrid exists
            if (!portfolioGrid) {
                console.error('Portfolio grid element not found!');
                return;
            }
            
            // Create an array to hold all portfolio items before adding to DOM
            let allPortfolioItems = [];
            let totalItems = 0;
            
            // Loop through categories
            for (const category in portfolioData) {
                const { folderName, count, title, description } = portfolioData[category];
                
                // Create an array of indices and shuffle them
                let indices = Array.from({length: count}, (_, i) => i + 1);
                indices = shuffleArray(indices);
                
                // Generate items for each category with shuffled indices
                for (let i = 0; i < count; i++) {
                    const shuffledIndex = indices[i];
                    const imagePath = `${baseImagePath}${folderName}/Post (${shuffledIndex})${imageExtension}`;
                    
                    // Debug log to check image paths
                    console.log(`Loading image: ${imagePath}`);
                    
                    const portfolioItem = document.createElement('div');
                    portfolioItem.className = 'portfolio-item';
                    portfolioItem.setAttribute('data-category', category);
                    portfolioItem.setAttribute('data-index', totalItems);
                    totalItems++;
                    
                    portfolioItem.innerHTML = `
                        <div class="portfolio-image" data-image="${imagePath}" data-title="${title} #${shuffledIndex}" data-category="${category.replace(/-/g, ' ')}">
                            <img src="${imagePath}" alt="${title} Design ${shuffledIndex}" 
                                 onerror="this.onerror=null; this.parentNode.innerHTML='<div style=\\'position:absolute;top:0;left:0;width:100%;height:100%;display:flex;align-items:center;justify-content:center;background:#f8f8f8;\\'><div style=\\'text-align:center;padding:20px;\\'><div style=\\'font-size:16px;margin-bottom:5px;color:#333;\\'>${title} #${shuffledIndex}</div><div style=\\'font-size:12px;color:#777;\\'>Image not found</div></div></div>';">
                        </div>
                    `;
                    
                    allPortfolioItems.push(portfolioItem);
                }
            }
            
            // Total items count (kept for internal use)
            console.log(`Total projects: ${totalItems}`);
            
            // Shuffle all portfolio items across categories for a completely random order
            shuffleArray(allPortfolioItems);
            
            // Append all shuffled items to the grid
            allPortfolioItems.forEach(item => {
                portfolioGrid.appendChild(item);
            });
            
            // Add event listeners to portfolio images
            document.querySelectorAll('.portfolio-image').forEach(image => {
                image.addEventListener('click', function(e) {
                    e.preventDefault();
                    const imageSrc = this.getAttribute('data-image');
                    const itemIndex = parseInt(this.parentNode.getAttribute('data-index'));
                    openModal(imageSrc, this.getAttribute('data-title'), this.getAttribute('data-category'), itemIndex);
                });
            });

            // Save settings to localStorage if images load successfully
            verifyImagesLoaded();
            
            // Initial filter to show all projects
            filterPortfolio('all');
        }

        // Verify if at least one image loads successfully
        function verifyImagesLoaded() {
            setTimeout(() => {
                const images = document.querySelectorAll('.portfolio-item img');
                let loadedCount = 0;
                let failedCount = 0;
                
                console.log(`Checking ${images.length} images...`);
                
                images.forEach(img => {
                    if (img.complete && img.naturalHeight !== 0) {
                        loadedCount++;
                    } else {
                        failedCount++;
                        console.error(`Failed to load image: ${img.src}`);
                    }
                });
                
                if (loadedCount > 0) {
                    console.log(`${loadedCount} images loaded successfully! ${failedCount} images failed.`);
                    // Save settings to localStorage
                    localStorage.setItem('portfolioBaseImagePath', baseImagePath);
                    localStorage.setItem('portfolioImageExtension', imageExtension);
                } else {
                    console.error('No images loaded successfully. Please check your paths.');
                    console.log('Trying alternative extension...');
                    
                    // Try alternative extension if all images failed
                    if (imageExtension === '.jpg') {
                        console.log('Switching from .jpg to .png');
                        imageExtension = '.png';
                        generatePortfolioItems();
                    } else if (imageExtension === '.png') {
                        console.log('Switching from .png to .jpg');
                        imageExtension = '.jpg';
                        generatePortfolioItems();
                    }
                }
            }, 2000);
        }

        // Filter function
        function filterPortfolio(category) {
            const items = document.querySelectorAll('.portfolio-item');
            const emptyState = document.getElementById('emptyState');
            
            currentCategory = category;
            visibleItems = [];
            let visibleCount = 0;
            
            // First collect all visible items
            items.forEach(item => {
                if (category === 'all' || item.getAttribute('data-category') === category) {
                    visibleItems.push(item);
                    visibleCount++;
                }
            });
            
            // Shuffle the visible items for a random order within the filter
            shuffleArray(visibleItems);
            
            // Now display or hide items
            items.forEach(item => {
                if (category === 'all' || item.getAttribute('data-category') === category) {
                    item.style.display = 'block';
                } else {
                    item.style.display = 'none';
                }
            });
            
            // Visible items count (kept for internal use)
            console.log(`Visible projects: ${visibleCount}`);
            
            // Show/hide empty state
            if (visibleCount === 0) {
                emptyState.style.display = 'block';
            } else {
                emptyState.style.display = 'none';
            }
        }

        // Modal functions
        function openModal(imageSrc, title, category, itemIndex) {
            const modal = document.getElementById('projectModal');
            const modalBody = document.getElementById('modalBody');
            const prevBtn = document.getElementById('prevProject');
            const nextBtn = document.getElementById('nextProject');
            
            currentImageIndex = itemIndex;
            
            // Set the category as a data attribute on the modal body for special styling
            modalBody.setAttribute('data-category', category.replace(/ /g, '-'));
            
            updateModalContent(imageSrc, title);
            
            modal.style.display = 'flex';
            
            // Setup navigation buttons
            setupModalNavigation(prevBtn, nextBtn);
            
            // Close modal when clicking the X
            const closeButton = document.querySelector('.close-modal');
            closeButton.addEventListener('click', function() {
                modal.style.display = 'none';
            });
            
            // Close modal when clicking outside
            window.addEventListener('click', function(e) {
                if (e.target === modal) {
                    modal.style.display = 'none';
                }
            });
            
            // Close modal when pressing Escape key
            window.addEventListener('keydown', function(e) {
                if (e.key === 'Escape' && modal.style.display === 'flex') {
                    modal.style.display = 'none';
                }
                
                // Navigate with arrow keys
                if (modal.style.display === 'flex') {
                    if (e.key === 'ArrowRight') {
                        navigateToNextItem();
                    } else if (e.key === 'ArrowLeft') {
                        navigateToPrevItem();
                    }
                }
            });
        }
        
        function updateModalContent(imageSrc, title) {
            const modalBody = document.getElementById('modalBody');
            const category = modalBody.getAttribute('data-category');
            
            // Determine if this is an A4 poster for special handling
            const isA4Poster = category === 'A4-size-Posters';
            
            modalBody.innerHTML = `
                <div class="modal-image">
                    <img src="${imageSrc}" alt="${title}" 
                         ${isA4Poster ? 'class="a4-poster"' : ''}
                         onerror="this.onerror=null; this.parentNode.innerHTML='<div style=\\'height:100%;display:flex;align-items:center;justify-content:center;background:#f0f0f0;\\'><div style=\\'text-align:center;padding:20px;\\'><div style=\\'font-size:18px;color:#666;margin-bottom:10px;\\'>Image could not be loaded</div><div style=\\'font-size:14px;color:#999;\\'>Please try again later</div></div></div>';">
                </div>
                <div class="modal-title">${title}</div>
            `;
        }
        
        function setupModalNavigation(prevBtn, nextBtn) {
            // Remove existing event listeners
            prevBtn.replaceWith(prevBtn.cloneNode(true));
            nextBtn.replaceWith(nextBtn.cloneNode(true));
            
            // Get fresh references
            const newPrevBtn = document.getElementById('prevProject');
            const newNextBtn = document.getElementById('nextProject');
            
            // Add new event listeners
            newPrevBtn.addEventListener('click', navigateToPrevItem);
            newNextBtn.addEventListener('click', navigateToNextItem);
        }
        
        function navigateToPrevItem() {
            if (visibleItems.length === 0) return;
            
            currentImageIndex = (currentImageIndex - 1 + visibleItems.length) % visibleItems.length;
            navigateToItem(currentImageIndex);
        }
        
        function navigateToNextItem() {
            if (visibleItems.length === 0) return;
            
            currentImageIndex = (currentImageIndex + 1) % visibleItems.length;
            navigateToItem(currentImageIndex);
        }
        
        function navigateToItem(index) {
            const item = visibleItems[index];
            if (!item) return;
            
            const portfolioImage = item.querySelector('.portfolio-image');
            const imageSrc = portfolioImage.getAttribute('data-image');
            const title = portfolioImage.getAttribute('data-title');
            
            updateModalContent(imageSrc, title);
        }

        // Load settings from localStorage if available
        function loadStoredSettings() {
            const storedPath = localStorage.getItem('portfolioBaseImagePath');
            const storedExtension = localStorage.getItem('portfolioImageExtension');
            
            if (storedPath) {
                baseImagePath = storedPath;
            }
            
            if (storedExtension) {
                imageExtension = storedExtension;
            }
        }

        // Mobile menu toggle
        function setupMobileMenu() {
            const menuToggle = document.getElementById('menuToggle');
            const navLinks = document.getElementById('navLinks');
            
            if (menuToggle) {
                menuToggle.addEventListener('click', function() {
                    navLinks.classList.toggle('active');
                    
                    // Toggle between hamburger and close icon
                    const icon = this.querySelector('i');
                    if (icon.classList.contains('fa-bars')) {
                        icon.classList.remove('fa-bars');
                        icon.classList.add('fa-times');
                    } else {
                        icon.classList.remove('fa-times');
                        icon.classList.add('fa-bars');
                    }
                });
            }
            
            // Close menu when clicking a link
            document.querySelectorAll('.nav-links a').forEach(link => {
                link.addEventListener('click', function() {
                    navLinks.classList.remove('active');
                    
                    // Reset icon
                    const icon = menuToggle.querySelector('i');
                    icon.classList.remove('fa-times');
                    icon.classList.add('fa-bars');
                });
            });
        }

        // Initialize the portfolio
        document.addEventListener('DOMContentLoaded', function() {
            // Setup mobile menu
            setupMobileMenu();
            
            // Load stored settings if available
            loadStoredSettings();
            
            // Generate portfolio items with initial settings
            generatePortfolioItems();
            
            // Add event listeners to filter buttons
            document.querySelectorAll('.filter-btn').forEach(button => {
                button.addEventListener('click', function() {
                    // Remove active class from all buttons
                    document.querySelectorAll('.filter-btn').forEach(btn => {
                        btn.classList.remove('active');
                    });
                    
                    // Add active class to clicked button
                    this.classList.add('active');
                    
                    // Filter portfolio with the selected category
                    const category = this.getAttribute('data-filter');
                    
                    // If it's the same category as current, reshuffle the items
                    if (category === currentCategory) {
                        // Reshuffle the visible items
                        const portfolioGrid = document.getElementById('portfolioGrid');
                        const items = Array.from(portfolioGrid.querySelectorAll('.portfolio-item[data-category="' + category + '"]'));
                        
                        if (category === 'all') {
                            // For "all" category, shuffle all items
                            const allItems = Array.from(portfolioGrid.querySelectorAll('.portfolio-item'));
                            shuffleArray(allItems);
                            
                            // Remove all items
                            while (portfolioGrid.firstChild) {
                                portfolioGrid.removeChild(portfolioGrid.firstChild);
                            }
                            
                            // Add them back in shuffled order
                            allItems.forEach(item => {
                                portfolioGrid.appendChild(item);
                            });
                        } else {
                            // For specific category, shuffle only those items
                            shuffleArray(items);
                            
                            // Remove those items
                            items.forEach(item => {
                                portfolioGrid.removeChild(item);
                            });
                            
                            // Add them back in shuffled order
                            items.forEach(item => {
                                portfolioGrid.appendChild(item);
                            });
                        }
                    }
                    
                    // Apply the filter
                    filterPortfolio(category);
                });
            });
            
            // Add event listener to reset filter button
            document.querySelector('.reset-filter-btn').addEventListener('click', function() {
                // Reset to "All Projects" filter
                const allButton = document.querySelector('.filter-btn[data-filter="all"]');
                allButton.click();
            });
        });
    </script>
    <!-- Floating Social Media Buttons -->
    <div class="floating-social">
        <div class="back-to-top" id="backToTop">
            <i class="fas fa-arrow-up"></i>
        </div>
        <a href="https://wa.link/gptr4p" class="whatsapp" target="_blank" aria-label="Contact on WhatsApp">
            <i class="fab fa-whatsapp"></i>
        </a>
        <a href="https://instagram.com/designer_kunshi" class="instagram" target="_blank" aria-label="Follow on Instagram">
            <i class="fab fa-instagram"></i>
        </a>
    </div>

    <script src="loader.js"></script>
    <script src="image-protection.js"></script>
    <script src="smooth-navigation.js"></script>
    <script>
        // Back to top button functionality
        document.addEventListener('DOMContentLoaded', function() {
            const backToTopButton = document.getElementById('backToTop');
            
            // Show button when user scrolls down 300px
            window.addEventListener('scroll', () => {
                if (window.pageYOffset > 300) {
                    backToTopButton.classList.add('show');
                } else {
                    backToTopButton.classList.remove('show');
                }
            });
            
            // Scroll to top when button is clicked
            backToTopButton.addEventListener('click', () => {
                window.scrollTo({
                    top: 0,
                    behavior: 'smooth'
                });
            });
            

        });
    </script>
</body>
</html>